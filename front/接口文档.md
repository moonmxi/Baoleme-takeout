# 一、配置

- **JDK** ：JDK17
- **SpringBoot ：**SpringBoot3
- **Vue**：Vue3
- **DataBase**：MySQL8

# 三、接口文档

## 1. 文档概览

## 2. 公共约定

- 参数，方法名统一用首字母小写的驼峰

- 类名统一用驼峰命名

- 包名全部小写

- 设置工具类Response：一个泛型响应类，用于封装响应数据，包裹data和相应的成功状态和错误信息:

  - ```typescript
    package org.demo.baoleme.dto.response;
    
    import lombok.AllArgsConstructor;
    import lombok.Data;
    import lombok.NoArgsConstructor;
    
    /**
     * 通用响应包装类，用于封装接口返回值
     * @param <T> 响应数据的类型
     */
    @Data
    @NoArgsConstructor
    @AllArgsConstructor
    public class Response<T> {
    
        /** 响应数据本体 */
        private T data;
    
        /** 是否成功 */
        private boolean success;
    
        /** 错误信息（仅在失败时使用） */
        private String errorMsg;
    
        /**
         * 构造一个成功响应
         * @param data 响应数据
         * @param <K> 数据类型
         * @return Response<K>
         */
        public static <K> Response<K> newSuccess(K data) {
            return new Response<>(data, true, null);
        }
    
        /**
         * 构造一个失败响应（不包含数据）
         * @param errorMsg 错误提示信息
         * @param <K> 数据类型
         * @return Response<K>
         */
        public static <K> Response<K> newError(String errorMsg) {
            return new Response<>(null, false, errorMsg);
        }
    
        /**
         * 构造一个失败响应（包含数据）
         * @param data 错误时附带的数据
         * @param errorMsg 错误信息
         * @param <K> 数据类型
         * @return Response<K>
         */
        public static <K> Response<K> newError(K data, String errorMsg) {
            return new Response<>(data, false, errorMsg);
        }
    }
    ```

  - 方法public static <K> Response<K> newSuccess(K data):创建一个新的成功的响应实例，并包含提供的数据

  -  @param data 要包含在成功响应中的数据

  -  @param <K> 数据的类型

  -  @return 一个新的响应实例，指示成功

  - 方法public static <K> Response<K> newError(K data):*创建一个新的错误响应实例，并包含提供的数据*

  -  @param data 要包含在错误响应中的数据

  -  @param <K> 数据的类型

  -  @return 一个新的响应实例，指示失败

      **于是下面的返回参数应如下**：

    ```JSON
    {
      "data"：{...}
      "success":true/false
      "errorMsg":...
    }
    ```

## 3. 模块接口列表

### 3.1 用户模块接口文档

#### 3.1.1. 用户注册接口

- **接口名称**：用户注册
- **请求地址**：`/user/register`
- **请求方式**：POST
- **请求参数**：

| 参数名   | 类型   | 是否必填 | 说明   |
| -------- | ------ | -------- | ------ |
| username | string | 是       | 用户名 |
| password | string | 是       | 密码   |
| phone    | string | 是       | 手机号 |

- **返回示例**：

成功：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "user_id": 10000003,
        "username": "peko",
        "phone": "11111111111"
    },
    "code": 200
}
```

失败：

```JSON
{
    "success": false,
    "message": "注册失败：用户名或手机号已存在",
    "code": 400
}
```

#### 3.1.2. 用户登录接口

- **接口名称**：用户登录
- **请求地址**：`/user/login`
- **请求方式**：POST
- **请求参数**：

| 参数名   | 类型   | 是否必填 | 说明   |
| -------- | ------ | -------- | ------ |
| phone    | string | 是       | 手机号 |
| password | string | 是       | 密码   |

- **返回示例**：

成功：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "token": "eyJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoidXNlciIsInVzZXJfaWQiOjEwMDAwMDAzLCJ1c2VybmFtZSI6InBla28iLCJpYXQiOjE3NDc1NzEyNzcsImV4cCI6MTc0NzY1NzY3N30.GpW_vMoOpbVj4yYi0iN8fafmQFg53vNqxQJSyMFU6UY",
        "username": "peko",
        "user_id": 10000003
    },
    "code": 200
}
```

#### 3.1.3. 用户登出接口

- **接口名称**：用户登出
- **请求地址**：`/user/logout`
- **请求方式**：POST
- **请求参数**：无（需在header中带token） 
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

#### 3.1.4. 获取当前用户信息接口

- **接口名称**：获取信息
- **请求地址**：`/user/info`
- **请求方式**：GET
- **请求参数**：无（需在header中带token）
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "user_id": 10000005,
        "username": "pekora",
        "phone": "11111111112",
        "avatar":"string",
        "description":"string",
        "location":"string",
        "gender":"string"
    },
    "code": 200
}
```

#### 3.1.5. 修改用户信息接口

- **接口名称**：修改信息
- **请求地址**：`/user/update`
- **请求方式**：PUT
- **请求参数**（可以只传需要修改的字段）：

| 参数名      | 类型   | 是否必填 | 说明           |
| ----------- | ------ | -------- | -------------- |
| username    | string | 否       | 修改后的用户名 |
| phone       | string | 否       | 修改后的手机号 |
| password    | string | 否       | 修改后的密码   |
| description | string | 否       | 个性签名       |
| location    | string | 否       | 地址           |
| avator      | string | 否       | 头像           |

- **返回示例**：（如果改用户名了会返回新的token）

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "token": "eyJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoidXNlciIsInVzZXJfaWQiOjEwMDAwMDA1LCJ1c2VybmFtZSI6Imt1c29QRUtPcmFhYSIsImlhdCI6MTc0ODM1NjQ1NSwiZXhwIjoxNzQ4NDQyODU1fQ.ffrmKvDLOL9krePDYrSJD_G9BDpeMG5RDgWIjLUOHzY",
        "username": "kusoPEKOraaa",
        "user_id": 10000005
    },
    "code": 200
}
```

#### 3.1.6. 用户订单记录接口

- **接口名称**：查看订单记录
- **请求地址**：`/user/history`
- **请求方式**：POST
- **请求参数**：

| 参数名     | 类型    | 是否必填 | 说明 |
| ---------- | ------- | -------- | ---- |
| status     | Integer | 否       |      |
| start_time | String  | 否       |      |
| end_time   | String  | 否       |      |
| page       | Integer | 是       |      |
| page_size  | Integer | 是       |      |

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "orders": [
            {
                "order_id": 80000002,
                "created_at": "2025-05-25T02:31:50",
                "ended_at": null,
                "status": 1,
                "store_name": "健康沙拉",
                "remark": null,
                "rider_name": "rider02",
                "rider_phone": "15000002222"
            },
            {
                "order_id": 80000003,
                "created_at": "2025-05-25T02:31:50",
                "ended_at": null,
                "status": 0,
                "store_name": "快餐小馆",
                "remark": null,
                "rider_name": "rider01",
                "rider_phone": "15000001111"
            }
        ]
    },
    "code": 200
}
```

#### 3.1.7.用户查看订单明细接口

- **接口名称**：查看订单明细
- **请求地址**：`/user//history/item`
- **请求方式**：POST
- **请求参数**：Long orderId
- 

#### 3.1.7. 用户收藏店铺接口

- **接口名称**：收藏店铺
- **请求地址**：`/user/favorite`
- **请求方式**：POST
- **请求参数**：

| 参数名   | 类型   | 是否必填 | 说明   |
| -------- | ------ | -------- | ------ |
| store_id | bigint | 是       | 店铺ID |

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

#### 3.1.8. 用户浏览收藏店铺接口

- **接口名称**：浏览收藏店铺
- **请求地址**：`/user/favorite/wat``ch`
- **请求方式**：POST
- **请求参数**：

```TypeScript
String type;
BigDecimal distance;
BigDecimal wishPrice;
BigDecimal startRating;
BigDecimal endRating;
Integer page;
Integer pageSize;
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": [
        {
            "store_id": 50000002,
            "name": "健康沙拉",
            "description": "新鲜健康，绿色食品",
            "location": "天津校园内B区",
            "type": "快餐",
            "rating": 4.5,
            "status": 1,
            "created_at": "2025-05-24T04:32:33",
            "image": "store2.jpg"
        },
        {
            "store_id": 50000003,
            "name": "快餐小馆",
            "description": "快捷实惠，味道不错",
            "location": "天津校园内C区",
            "type": "快餐",
            "rating": 4.0,
            "status": 1,
            "created_at": "2025-05-24T04:32:33",
            "image": "store3.jpg"
        }
    ],
    "code": 200
}
```

#### 3.1.9. 用户查看优惠券接口

- **请求地址**：`/user/coupon`
- **请求方式**：GET
- **请求参数**：无
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": [
        {
            "coupon_id": 1,
            "type": "1",
            "discount": 10.00,
            "expiration_date": null,
            "full_amount": null,
            "reduce_amount": null
        },
        {
            "coupon_id": 2,
            "type": "2",
            "discount": null,
            "expiration_date": null,
            "full_amount": 20,
            "reduce_amount": 6
        }
    ],
    "code": 200
}
```

#### 3.1.10.用户领取优惠券

- **请求地址**：`/user/coupon/claim`
- **请求方式**：POST
- **请求参数**：

| 参数名 | 类型    | 是否必填 | 说明                     |
| ------ | ------- | -------- | ------------------------ |
| type   | Integer | 是       | 优惠券类型 1 折扣 2 满减 |

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

#### 3.1.11. 用户注销接口

- **接口名称**：用户注销
- **请求地址**：`/user/``delete`
- **请求方式**：DELETE
- **请求参数**：无（需在header中带token） 
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

#### 3.1.12. 用户查看当前订单接口

- **接口名称**：查看订单记录
- **请求地址**：`/user/current`
- **请求方式**：POST
- **请求参数**：

Integer Page、page_size

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "orders": [
            {
                "order_id": 80000001,
                "created_at": "2025-06-05T04:54:19",
                "status": 2,
                "remark": "尽快送达",
                "user_location": "北京海淀区小区A栋",
                "store_location": "北京海淀区",
                "total_price": 66.00,
                "actual_price": 63.00,
                "delivery_price": 3.00,
                "store_name": "快餐小屋01",
                "rider_name": "rider01",
                "rider_phone": "15000001111",
                "store_phone": "13900001111"
            },
            {
                "order_id": 80000002,
                "created_at": "2025-06-05T04:54:19",
                "status": 1,
                "remark": null,
                "user_location": "上海浦东新区小区B栋",
                "store_location": "上海浦东新区",
                "total_price": 45.00,
                "actual_price": 45.00,
                "delivery_price": 0.00,
                "store_name": "甜品乐园02",
                "rider_name": "rider02",
                "rider_phone": "15000002222",
                "store_phone": "13900002222"
            },
            {
                "order_id": 80000004,
                "created_at": "2025-06-05T04:54:19",
                "status": 0,
                "remark": null,
                "user_location": "广州天河区小区D栋",
                "store_location": "广州天河区",
                "total_price": 30.00,
                "actual_price": 30.00,
                "delivery_price": 0.00,
                "store_name": "面食大师04",
                "rider_name": "rider04",
                "rider_phone": "15000004444",
                "store_phone": "13900004444"
            },
            {
                "order_id": 80000005,
                "created_at": "2025-06-05T04:54:19",
                "status": 2,
                "remark": "加快配送",
                "user_location": "深圳罗湖区小区E栋",
                "store_location": "深圳罗湖区",
                "total_price": 50.00,
                "actual_price": 47.00,
                "delivery_price": 3.00,
                "store_name": "烧烤天地05",
                "rider_name": "rider05",
                "rider_phone": "15000005555",
                "store_phone": "13900005555"
            },
            {
                "order_id": 80000006,
                "created_at": "2025-06-05T04:54:19",
                "status": 1,
                "remark": null,
                "user_location": "南京鼓楼区小区F栋",
                "store_location": "南京鼓楼区",
                "total_price": 35.00,
                "actual_price": 35.00,
                "delivery_price": 0.00,
                "store_name": "汉堡王06",
                "rider_name": "rider01",
                "rider_phone": "15000001111",
                "store_phone": "13900006666"
            },
            {
                "order_id": 80000008,
                "created_at": "2025-06-05T04:54:19",
                "status": 0,
                "remark": null,
                "user_location": "成都武侯区小区H栋",
                "store_location": "成都武侯区",
                "total_price": 58.00,
                "actual_price": 58.00,
                "delivery_price": 0.00,
                "store_name": "小龙虾08",
                "rider_name": "rider03",
                "rider_phone": "15000003333",
                "store_phone": "13900008888"
            },
            {
                "order_id": 80000009,
                "created_at": "2025-06-05T04:54:19",
                "status": 2,
                "remark": "少糖",
                "user_location": "武汉洪山区小区I栋",
                "store_location": "武汉洪山区",
                "total_price": 40.00,
                "actual_price": 37.00,
                "delivery_price": 3.00,
                "store_name": "咖啡时光09",
                "rider_name": "rider04",
                "rider_phone": "15000004444",
                "store_phone": "13900009999"
            },
            {
                "order_id": 80000010,
                "created_at": "2025-06-05T04:54:19",
                "status": 1,
                "remark": null,
                "user_location": "西安雁塔区小区J栋",
                "store_location": "西安雁塔区",
                "total_price": 60.00,
                "actual_price": 60.00,
                "delivery_price": 0.00,
                "store_name": "比萨之家10",
                "rider_name": "rider05",
                "rider_phone": "15000005555",
                "store_phone": "13900001010"
            },
            {
                "order_id": 80000011,
                "created_at": "2025-06-05T04:54:19",
                "status": 0,
                "remark": null,
                "user_location": "长沙岳麓区小区K栋",
                "store_location": "长沙岳麓区",
                "total_price": 32.00,
                "actual_price": 32.00,
                "delivery_price": 0.00,
                "store_name": "盖饭达人11",
                "rider_name": "rider01",
                "rider_phone": "15000001111",
                "store_phone": "13900001112"
            },
            {
                "order_id": 80000013,
                "created_at": "2025-06-05T04:54:19",
                "status": 2,
                "remark": "送餐电话",
                "user_location": "大连甘井子区小区M栋",
                "store_location": "大连甘井子区",
                "total_price": 48.00,
                "actual_price": 45.00,
                "delivery_price": 3.00,
                "store_name": "寿司吧13",
                "rider_name": "rider03",
                "rider_phone": "15000003333",
                "store_phone": "13900001313"
            }
        ]
    },
    "code": 200
}
```

#### **3.1.13 用户搜索接口****（待更改，未加条件和分页）**

- **接口名称**：全局搜索
- **请求地址**：`/user/search`
- **请求方式**：POST
- **请求参数**：

```TypeScript
String keyword;
BigDecimal distance;
BigDecimal wishPrice;
BigDecimal startRating;
BigDecimal endRating;
Integer page;
Integer pageSize;
```

- **返回示例**：

```json
{
    "success": true,
    "message": "success",
    "data": {
        "reults": [
            {
                "store_id": 50000006,
                "name": "汉堡王06",
                "description": "经典汉堡",
                "location": "南京鼓楼区",
                "type": "快餐",
                "rating": 4.4,
                "status": 1,
                "created_at": "2025-06-04T20:54:19",
                "image": "store6.jpg"
            },
            {
                "store_id": 50000010,
                "name": "比萨之家10",
                "description": "意式披萨",
                "location": "西安雁塔区",
                "type": "快餐",
                "rating": 4.6,
                "status": 1,
                "created_at": "2025-06-04T20:54:19",
                "image": "store10.jpg"
            }
        ]
    },
    "code": 200
}
```

#### **3.1.14 查看****推荐****店铺****列表接口**

- **接口名称**：店铺列表
- **请求地址**：`/store/user-view-stores`
- **请求方式**：POST
- **请求参数**：

```TypeScript
String type;
BigDecimal distance;
BigDecimal wishPrice;
BigDecimal startRating;
BigDecimal endRating;
Integer page;
Integer pageSize;
```

- **返回示例**：

```json
{
    "success": true,
    "message": "success",
    "data": {
        "data": [
            {
                "id": 50000003,
                "merchant_id": null,
                "name": "快餐小馆",
                "description": "快捷实惠，味道不错",
                "location": "天津校园内C区",
                "rating": 4.0,
                "balance": 0,
                "status": 1,
                "created_at": "2025-05-22T04:46:40",
                "image": "store3.jpg"
            },
            {
                "id": 50000002,
                "merchant_id": null,
                "name": "健康沙拉",
                "description": "新鲜健康，绿色食品",
                "location": "天津校园内B区",
                "rating": 4.5,
                "balance": 0,
                "status": 1,
                "created_at": "2025-05-22T04:46:40",
                "image": "store2.jpg"
            },
            {
                "id": 50000001,
                "merchant_id": null,
                "name": "美味炸鸡",
                "description": "校园内最好吃的炸鸡店",
                "location": "天津校园内A区",
                "rating": 4.8,
                "balance": 0,
                "status": 1,
                "created_at": "2025-05-22T04:46:40",
                "image": "store1.jpg"
            }
        ],
        "total": 3,
        "type": null,
        "min_rating": 0.0,
        "max_rating": 0.0,
        "page": 0,
        "size": 0
    },
    "code": 200
}
```

#### **3.1.15 查看****某店铺****商品列表接口**

- **接口名称**：商品列表
- **请求地址**：`/store/user-view-products`
- **请求方式**：POST
- **请求参数**：

| 参数名   | 类型   | 是否必填 | 说明                     |
| -------- | ------ | -------- | ------------------------ |
| store_id | bigint | 是       | 店铺ID                   |
| category | string | 否       | 商品分类（如饮品、主食） |

- **返回示例**：

```json
{
    "success": true,
    "message": "success",
    "data": {
        "data": [
            {
                "id": 60000013,
                "store_id": 50000011,
                "name": "三文鱼寿司",
                "description": "新鲜三文鱼",
                "price": 48.00,
                "category": "快餐",
                "stock": 60,
                "rating": 4.8,
                "status": 1,
                "created_at": "2025-06-04T20:54:19",
                "image": "prod13.jpg"
            },
            {
                "id": 60000011,
                "store_id": 50000011,
                "name": "照烧鸡腿盖饭",
                "description": "香甜照烧酱",
                "price": 32.00,
                "category": "快餐",
                "stock": 110,
                "rating": 4.5,
                "status": 1,
                "created_at": "2025-06-04T20:54:19",
                "image": "prod11.jpg"
            }
        ],
        "shop_id": 50000011,
        "category": "快餐"
    },
    "code": 200
}
```

#### **3.1.16 用户评价接口**

- **接口名称**：提交评价
- **请求地址**：`/user/review`
- **请求方式**：POST
- **请求参数**：

| 参数名     | 类型         | 是否必填 | 说明                   |
| ---------- | ------------ | -------- | ---------------------- |
| store_id   | Long         | 是       | 店铺id                 |
| product_id | Long         | 否       | 产品id                 |
| rating     | BigDecimal   | 是       | 评分（1-5星）          |
| comment    | string       | 否       | 评论内容               |
| images     | List<String> | 否       | 图片URL列表（最多3张） |

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

#### **3.1.17 用户下单接口**

- **接口名称**：提交订单
- **请求地址**：`/user/order`
- **请求方式**：POST
- **请求参数**：

```JSON
{
  "items": [
    { "product_id": 101, "quantity": 2 },
    { "product_id": 102, "quantity": 1 }
  ],
  "coupon_id": 500000005,
  "delivery_price": 3.00,
  "store_id": 12,
  "remark": "请尽快送达"
}
```

- **返回示例**：

```json
{
    "success": true,
    "message": "success",
    "data": {
        "order_id": 1926270955248713737,
        "store_id": 50000001,
        "store_name": "美味炸鸡",
        "remark": "不要辣，请尽快送达",
        "total_price": 38.00,
        "actual_price": 46.50,
        "status": 0,
        "items": [
            {
                "image": "prod1.jpg",
                "quantity": 2,
                "price": 15.00,
                "name": "炸鸡翅2",
                "description": "香辣可口炸鸡翅"
            },
            {
                "image": "prod2.jpg",
                "quantity": 1,
                "price": 8.00,
                "name": "薯条2",
                "description": "黄金脆薯条"
            }
        ],
        "created_at": "2025-05-25T18:50:16.076232"
    },
    "code": 200
}
```

#### **3.1.18 用户根据订单id查询订单**

- **接口名称**：查询订单
- **请求地址**：`/user/searchOrder`
- **请求方式**：POST
- **请求参数**：Long order_id

#### 3.1.19 用户根据订单id查询订单明细

- **接口名称**：查询订单
- **请求地址**：`/user/searchOrderItem`
- **请求方式**：POST
- **请求参数**：Long order_id

#### 3.1.20 用户查商品详细信息

- **接口名称**：查商品详细信息（带评价
- **请求地址**：`/product/prodectInfo`
- **请求方式**：POST
- **请求参数**：Long id
- 返回示例

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "id": 60000001,
        "store_id": null,
        "name": "鸡腿汉堡",
        "category": "快餐",
        "price": 22.00,
        "description": "经典鸡腿堡",
        "image": "prod1.jpg",
        "stock": 150,
        "rating": 4.7,
        "status": 1,
        "reviews": [
            {
                "id": 100000001,
                "user_id": 10000001,
                "store_id": 50000001,
                "product_id": 60000001,
                "rating": 5,
                "comment": "鸡腿汉堡味道很赞！",
                "image": "review1.jpg",
                "created_at": "2025-06-04T20:54:19"
            }
        ],
        "created_at": "2025-06-04T20:54:19"
    },
    "code": 200
}
```

#### 3.1.21 用户查店铺详细信息

- **接口名称**：查店铺详细信息
- **请求地址**：`/store/storeInfo`
- **请求方式**：POST
- **请求参数**：Long id

#### 3.1.22 更新浏览记录（没有就add，有就update 

- **接口名称**：更新浏览记录
- **请求地址**：`/user/updateViewHistory`
- **请求方式**：POST
- **请求参数**：

private Long storeId;

private LocalDateTime viewTime;

#### 3.1.23 查看浏览记录（返回店铺信息

- **接口名称**：查看浏览记录
- **请求地址**：`/user/viewHistory`
- **请求方式**：POST
- **请求参数**：

private Integer page;

private Integer pageSize;

返回示例：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "stores": [
            {
                "id": 50000013,
                "merchant_id": 20000013,
                "name": "寿司吧13",
                "description": "新鲜寿司",
                "location": "大连甘井子区",
                "type": "快餐",
                "rating": 4.7,
                "status": 1,
                "created_at": "2025-06-04T20:54:19",
                "image": "store13.jpg"
            },
            {
                "id": 50000014,
                "merchant_id": 20000014,
                "name": "重庆小面14",
                "description": "重庆辣味小面",
                "location": "昆明五华区",
                "type": "面食",
                "rating": 4.8,
                "status": 1,
                "created_at": "2025-06-04T20:54:19",
                "image": "store14.jpg"
            },
            {
                "id": 50000015,
                "merchant_id": 20000015,
                "name": "花样蛋糕15",
                "description": "精致蛋糕店",
                "location": "沈阳和平区",
                "type": "甜品",
                "rating": 4.9,
                "status": 1,
                "created_at": "2025-06-04T20:54:19",
                "image": "store15.jpg"
            }
        ]
    },
    "code": 200
}
```

### 3.2 商家模块接口文档

#### 3.2.1. 商家注册

- **接口名称**：商家注册
- **请求地址**：`/merchant/register`
- **请求方式**：POST
- **请求参数**：

| 参数名   | 类型   | 是否必填 | 说明   |
| -------- | ------ | -------- | ------ |
| username | string | 是       | 用户名 |
| password | string | 是       | 密码   |
| phone    | string | 是       | 手机号 |

- 请求体：

```JSON
{
    "username": "test",
    "password": "123456",
    "phone": "11111111111"
}
```

- **返回示例**：

成功：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "user_id": 20000004,
        "username": "test",
        "phone": "11111111111"
    },
    "code": 200
}
```

失败：

```JSON
{
  "code": 400,
  "data": null,
  "message": "手机号已被注册"
}
```

#### 3.2.2. 商家登录

- **接口名称**：商家登录
- **请求地址**：`/merchant/login`
- **请求方式**：POST
- **请求参数**：

| 参数名   | 类型   | 是否必填 | 说明   |
| -------- | ------ | -------- | ------ |
| phone    | string | 是       | 手机号 |
| password | string | 是       | 密码   |

- 请求体：

```JSON
{
    "phone": "11111111111",
    "password": "123456"
}
```

- **返回示例**：

成功：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "token": "eyJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoibWVyY2hhbnQiLCJ1c2VyX2lkIjoyMDAwMDAwNCwidXNlcm5hbWUiOiJ0ZXN0IiwiaWF0IjoxNzQ4MTcyNDY0LCJleHAiOjE3NDgyNTg4NjR9.hipU8JiagVkJ4l2FQLwNfy4PrxPB4EG_I1ZQ4bFy_jk",
        "user_id": 20000004,
        "expires_in": 86400000
    },
    "code": 200
}
```

失败：

```JSON
{
    "code": 401,
    "data": null,
    "message": "手机号或密码错误"
}
```

#### 3.2.3. 商家登出

- **接口名称**：商家登出
- **请求地址**：`/merchant/logout`
- **请求方式**：POST
- **请求参数**：无（需在header中带token） 
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

#### 3.2.4. 商家注销

- **接口名称**：商家注销
- **请求地址**：`/merchant/``delete`
- **请求方式**：DELETE
- **请求参数**：无（需在header中带token） 
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

#### 3.2.5. 获取当前商家信息

- **接口名称**：获取信息
- **请求地址**：`/merchant/info`
- **请求方式**：GET
- **请求参数**：无（需在header中带token）
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "user_id": 20000004,
        "username": "test",
        "phone": "11111111111",
        "created_at": "2025-05-25T19:25:33",
        "avatar": null
    },
    "code": 200
}
```

#### 3.2.6. 商家修改自身信息

- **接口名称**：修改商家信息
- **请求地址**：`/merchant``/update`
- **请求方式**：PUT
- **请求参数****（需在header中带token）**（可以只传需要修改的字段）：

| 参数名   | 类型   | 是否必填 | 说明           |
| -------- | ------ | -------- | -------------- |
| username | string | 否       | 修改后的用户名 |
| password | string | 否       | 修改后的密码   |
| phone    | string | 否       | 修改后的手机号 |
| avatar   | string | 否       | 修改后的头像   |

- 请求体：

```JSON
{
    "username": "test",
    "password": null,
    "phone": null,
    "avatar": "1.png"
}
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "user_id": 20000004,
        "username": "test",
        "phone": "11111111111",
        "avatar": null,
        "new_token": null
    },
    "code": 200
}
```

#### 3.2.7.商家管理店铺

##### 3.2.7.1 修改店铺信息

- **接口名称**：修改店铺信息
- **请求地址**：`/``store``/update`
- **请求方式**：PUT
- **请求参数（需在header中带token）**（可以只传需要修改的字段）：

| 参数名      | 类型    | 是否必填 | 说明           |
| ----------- | ------- | -------- | -------------- |
| id          | integer | 否       | 修改后的用户名 |
| name        | string  | 否       | 修改后的手机号 |
| description | string  | 是       | 修改后的密码   |
| location    | string  | 否       | 头像           |
| status      | integer | 否       | 状态           |
| image       | string  | 否       | 头像           |
| type        | string  | 否       | 类型           |

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "name": "铁娜",
        "description": "occaecat aliqua eiusmod irure sint",
        "location": "qui ut",
        "rating": 5.0,
        "status": 0,
        "created_at": "2025-05-25T20:05:35",
        "image": "http"
    },
    "code": 200
}
```

##### 3.2.7.2 商家创建店铺

- **请求地址**：`/``store``/create`
- **请求方式**：POST  
- **请求参数（需在header中带token）**：

| 参数名      | 类型   | 是否必填 | 说明 |
| ----------- | ------ | -------- | ---- |
| name        | string | 是       |      |
| description | string | 否       |      |
| location    | string | 否       |      |
| image       | string | 否       |      |
| type        | string | 否       |      |

- **请求体示例**：

```JSON
{
    "name": "A STORE",
    "descrition": "best",
    "location": "elit ut dolore",
    "type": "fruit",
    "image": "1.png"
}
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "id": 50000004
    },
    "code": 200
}
```

##### 3.2.7.3 商家删除店铺

- **请求地址**：`/s``tore/delete`
- **请求方式**：DELETE
- **请求参数（需在header中带token）**：
- **请求体示例**：

```JSON
{
    "store_id": 50000004
}
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": "店铺数据已删除",
    "code": 200
}
```

##### 3.2.7.4 查看店铺信息

- **请求地址**：`/store/view`
- **请求方式**：POST  
- **请求参数（需在header中带token）**：
- **请求体示例**：

```JSON
{
    "store_id": 50000004
}
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "name": "A STORE",
        "description": "best",
        "location": "elit ut dolore",
        "rating": 5.0,
        "status": 0,
        "created_at": "2025-05-25T20:05:35",
        "image": "1.png"
    },
    "code": 200
}
```

##### 3.2.7.5 查看店铺列表

- **请求地址**：`/store/list`
- **请求方式**：POST  
- **请求参数（需在header中带token）**：
- **请求体示例**：

```JSON
{
    "page": 1,
    "page_size": 10
}
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "stores": [
            {
                "name": "A STORE",
                "description": "best",
                "location": "elit ut dolore",
                "rating": 5.0,
                "status": 0,
                "created_at": "2025-05-25T20:05:35",
                "image": "1.png"
            }
        ],
        "current_page": 1
    },
    "code": 200
}
```

#### 3.2.8.1 商家查看店铺评价

- **接口名称**：商家查看店铺评价
- **请求地址：/store/reviews/list(所有评价）**
- **请求方式**：POST
- **请求参数**（可以只传需要修改的字段）：

| 参数名    | 类型    | 是否必填 | 说明                             |
| --------- | ------- | -------- | -------------------------------- |
| store_id  | bigint  | 是       | 有效店铺ID                       |
| hasImage  | Boolean | 否       | 带图=true，不带=false，都要=null |
| page      | int     | 否       | 分页页码（默认 1）               |
| page_size | int     | 否       | 每页数量（默认 10）              |

- 请求体

```JSON
{
    "store_id": 50000001
}
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "current_page": 1,
        "page_size": 10,
        "total_count": 4,
        "total_pages": 1,
        "pre_page": null,
        "next_page": null,
        "reviews": [
            {
                "user_id": 10000001,
                "username": "用户alice",
                "product_id": 60000004,
                "product_name": "贝梓睿",
                "rating": 5,
                "comment": "商品质量非常好，下次还会购买！",
                "created_at": "2025-05-25T22:10:39",
                "user_avatar": "avatar1.jpg",
                "image": "review_img1.jpg"
            },
            {
                "user_id": 10000001,
                "username": "用户alice",
                "product_id": null,
                "product_name": null,
                "rating": 4,
                "comment": "店员服务专业，但商品种类可以更丰富",
                "created_at": "2025-05-25T22:10:39",
                "user_avatar": "avatar1.jpg",
                "image": null
            },
            {
                "user_id": 10000001,
                "username": "用户alice",
                "product_id": 60000004,
                "product_name": "贝梓睿",
                "rating": 2,
                "comment": null,
                "created_at": "2025-05-25T22:10:39",
                "user_avatar": "avatar1.jpg",
                "image": null
            },
            {
                "user_id": 10000001,
                "username": "用户alice",
                "product_id": null,
                "product_name": null,
                "rating": 5,
                "comment": "👍 超赞的购物体验！快递次日达📦",
                "created_at": "2025-05-25T22:10:39",
                "user_avatar": "avatar1.jpg",
                "image": "special_chars.jpg"
            }
        ]
    },
    "code": 200
}
```

#### 3.2.8.2 商家筛选店铺评价

- **接口名称**：商家筛选店铺评价
- **请求地址：/store/reviews/filter**
- **请求方式**：POST
- **请求参数**（可以只传需要修改的字段）：

| 参数名    | 类型    | 是否必填 | 说明                |
| --------- | ------- | -------- | ------------------- |
| store_id  | bigint  | 是       | 有效店铺ID          |
| hasImage  | Boolean | 否       |                     |
| page      | int     | 否       | 分页页码（默认 1）  |
| page_size | int     | 否       | 每页数量（默认 10） |

- 请求体

```JSON
{
    "store_id": 50000001,
    "status":0
}
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "current_page": 1,
        "page_size": 10,
        "total_count": 2,
        "total_pages": 1,
        "pre_page": null,
        "next_page": null,
        "reviews": [
            {
                "user_id": 10000001,
                "username": "用户alice",
                "product_id": 60000004,
                "product_name": "贝梓睿",
                "rating": 5,
                "comment": "商品质量非常好，下次还会购买！",
                "created_at": "2025-05-25T22:10:39",
                "user_avatar": "avatar1.jpg",
                "image": "review_img1.jpg"
            },
            {
                "user_id": 10000001,
                "username": "用户alice",
                "product_id": null,
                "product_name": null,
                "rating": 5,
                "comment": "👍 超赞的购物体验！快递次日达📦",
                "created_at": "2025-05-25T22:10:39",
                "user_avatar": "avatar1.jpg",
                "image": "special_chars.jpg"
            }
        ]
    },
    "code": 200
}
```

#### 3.2.9. 商家管理商品

##### 3.2.9.1 新增商品

- **接口名称**：新增商品
- **请求地址**：`/``product`/create
- **请求方式**：POST
- **请求参数**：

| 参数名       | 类型    | 是否必填 | 说明     |
| ------------ | ------- | -------- | -------- |
| name         | string  | 是       | 商品名称 |
| descripition | string  | 是       | 商品描述 |
| price        | double  | 是       | 商品价格 |
| stock        | integer | 是       | 商品库存 |
| category     | string  | 否       | 商品标签 |
| image        | string  | 否       | 图片     |

- 请求示例

```JSON
{
    "store_id": 50000005,
    "name": "A PRODUCT",
    "price": 425.29,
    "stock": 47,
    "discription":"best",
    "category": "fruit",
    "image": "1.jpg"
}
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "product_id": 60000004
    },
    "code": 200
}
```

##### 3.2.9.2 修改商品信息

- **接口名称**：修改商品
- **请求地址**：`/product/``update/`
- **请求方式**：PUT
- **请求参数**：

| 参数名       | 类型    | 是否必填 | 说明           |
| ------------ | ------- | -------- | -------------- |
| product_id   | bigint  | 是       |                |
| name         | string  | 否       | 商品名称       |
| descripition | string  | 否       | 商品描述       |
| price        | double  | 否       | 商品价格       |
| stock        | integer | 否       | 商品库存       |
| category     | string  | 否       | 商品标签       |
| image        | string  | 否       | 图片           |
| status       | integer |          | 上架=1，下架=0 |

- 请求示例

```JSON
{
    "product_id": 60000004,
    "name": "贝梓睿",
    "description": "面这代。价北劳公置路几米交。整信认存对。收至会。",
    "price": 821.75,
    "category": "dolore",
    "image": "https",
    "status": 0
}
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "name": "贝梓睿",
        "description": "面这代。价北劳公置路几米交。整信认存对。收至会。",
        "price": 821.75,
        "category": "dolore",
        "stock": 47,
        "image": "https",
        "status": 0
    },
    "code": 200
}
```

##### 3.2.9.3 查看商品列表

- **接口名称**：查看商品
- **请求地址**：/product/store-products
- **请求方式**：POST
- **请求参数**：token

| 参数名      | 类型    | 是否必填 | 说明                  |
| ----------- | ------- | -------- | --------------------- |
| shore_id    | long    | 是       |                       |
| status      | bool    | 否       | 商品状态（上架/下架） |
| category_id | string  | 否       | 分类ID                |
| page        | integer |          |                       |
| page_size   | integer |          |                       |

- 请求示例

```JSON
{
    "store_id": 50000001
}
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "products": [
            {
                "id": 60000004,
                "name": "A PRODUCT",
                "description": null,
                "price": 425.29,
                "category": "fruit",
                "stock": 47,
                "rating": null,
                "status": 0,
                "created_at": "2025-05-25T20:12:46",
                "image": "1.jpg"
            }
        ],
        "current_page": 1,
        "total_pages": 1,
        "total_items": 1
    },
    "code": 200
}
```

##### 3.2.9.4.商家删除商品

- **接口名称**：查看商品
- **请求地址**：/product/delete
- **请求方式**：POST
- **请求参数**：token

| 参数名 | 类型 | 是否必填 | 说明 |
| ------ | ---- | -------- | ---- |
| id     |      |          |      |

- 请求示例

```JSON
{
    "product_id": 60000004
}
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": "商品删除成功",
    "code": 200
}
```

##### 3.2.9.5.查看单个商品

- **接口名称**：查看单个商品
- **请求地址**：/product/view
- **请求方式**：POST
- **请求参数**：token

| 参数名     | 类型   | 是否必填 | 说明 |
| ---------- | ------ | -------- | ---- |
| product_id | Bigint |          |      |

- 请求示例

```JSON
{
    "product_id": 60000004
}
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "id": 60000004,
        "name": "A PRODUCT",
        "description": null,
        "price": 425.29,
        "category": "fruit",
        "stock": 47,
        "rating": null,
        "status": 0,
        "created_at": "2025-05-25T20:12:46",
        "image": "1.jpg"
    },
    "code": 200
}
```

#### 3.2.10. 商家设置促销活动

- **接口名称**：新增coupon
- **请求地址**：`/coupon`/create
- **请求方式**：POST
- **请求参数**：

| 参数名        | 类型   | 是否必填 | 说明                                 |
| ------------- | ------ | -------- | ------------------------------------ |
| store_id      | int    | 是       |                                      |
| type          | int    | 是       | *1-折扣券 2-满减券*                  |
| discount      | double | 否       | */**折扣率（type=1时有效）\*/*       |
| full_amount   | double | 否       | */**满减条件金额（type=2时有效）\*/* |
| reduce_amount | double | 否       | */**满减优惠金额（type=2时有效）\*/* |

- 请求示例

```JSON
{
    "store_id": 50000005,
    "type": 1,
    "discount": 0.5,
    
    "full_amount": null,
    "reduce_amount": null,
}
```

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "coupon_id": 60000004
    },
    "code": 200
}
```

#### 3.2.11. 商家处理订单

##### 3.2.11.1 订单列表

- **接口名称：**订单列表
- **请求地址：**`/orde``rs/`merchant-list
- **请求方式：****POST**
- **请求参数：**

| 参数名    | 类型 | 是否必填 | 说明               |
| --------- | ---- | -------- | ------------------ |
| shop_id   |      | 是       |                    |
| status    | int  | 否       | Value: from 0 to 4 |
| page      |      |          |                    |
| page_size |      |          |                    |

- 请求示例：

```JSON
{
    "store_id": 40000002
}
```

- 返回示例：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "list": [
            {
                "order_id": 70000002,
                "user_name": 10000002,
                "status": 2,
                "total_price": 25.00,
                "created_at": "2025-05-19T11:12:22"
            }
        ],
        "current_page": 1,
        "page_size": 10,
        "total": 0
    },
    "code": 200
}
```

##### 3.2.10.2 订单操作

- **接口名称：**订单操作
- **请求地址：****/orders/merchant-update**
- **请求方式：****PUT**
- **请求参数：****header中带有token**

| 参数名     | 类型 | 是否必填 | 说明          |
| ---------- | ---- | -------- | ------------- |
| shop_id    |      | 是       |               |
| new_status | int  | 否       | Value: 2 or 4 |
| page       |      |          |               |
| page_size  |      |          |               |

```JSON
{
    "id": 70000002,
    "new_status": 2,
    "store_id": 40000002,
    "cancel_reason": "null"
}
```

- **返回示例：**

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "id": 70000002,
        "old_status": 2,
        "new_status": 2,
        "update_at": "2025-05-20T16:06:14.4241992",
        "cancel_reason": "null"
    },
    "code": 200
}
```

#### 3.2.12. 商家查看销售统计

##### 3.2.12.1 销售概况

- **接口名称：**销售概况
- **请求地址：****/stats****-store****/overview**
- **请求方式：**GET
- **请求参数：**

| 参数名     | 类型 | 是否必填 | 说明                               |
| ---------- | ---- | -------- | ---------------------------------- |
| store_id   | long | 是       |                                    |
| time_range | int  | 否       | 时间范围（TODAY=0/WEEK=1/MONTH=2） |

- 请求示例：

```JSON
{
    "store_id": 40000002,
    "time_range": 0
}
```

- 返回示例：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "total_sales": null,
        "order_count": 0,
        "popular_products": [
            {
                "id": 60000002,
                "store_id": 40000002,
                "name": "奶茶",
                "description": "香浓奶茶",
                "price": 15.00,
                "category": "饮品",
                "stock": null,
                "rating": null,
                "status": 1,
                "created_at": "2025-05-19T11:12:22",
                "image": null
            }
        ]
    },
    "code": 200
}
```

##### 3.2.12.2 销售趋势

- **接口名称：**销售趋势
- **请求地址：****/****stats-store****/trend**
- **请求方式：**GET
- **请求参数：**

| 参数名             | 类型 | 是否必填 | 说明                 |
| ------------------ | ---- | -------- | -------------------- |
| store_id           |      |          |                      |
| type               | int  | 是       | 0-按日 1-按周 2-按月 |
| num_of_recent_days | int  | 否       | 最近天数（默认7）    |

- 请求示例

```JSON
{
    "store_id": 40000002,
    "type": 0
}
```

- 返回示例：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "dates": [
            "2025-05-20"    // 年-月-日 type=0
                            // 年-周    type=1
                            // 年-月    type=2
        ],
        "values": [
            816
        ]
    },
    "code": 200
}
```

### 3.3 骑手模块接口文档

以下是基于功能需求的骑手接口设计，采用 RESTful 风格实现：

####  3.3.1 骑手注册

- **接口名称**：骑手注册
- **请求地址**：/rider/register
- **请求方式**：POST
- **请求参数**：

| 参数名     | 类型   | 是否必填 | 说明   |
| ---------- | ------ | -------- | ------ |
| `username` | string | true     | 用户名 |
| `phone`    | string | true     | 手机号 |
| `password` | string | true     | 密码   |

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "user_id": 30000005,
        "username": "Mxi_test",
        "phone": "12222222222"
    },
    "code": 200
}
```

#### 3.3.2  骑手登录

- **接口名称**：骑手登录
- **请求地址**：/rider/login
- **请求方式**：POST
- **请求参数**：

| 参数名     | 类型   | 是否必填 | 说明   |
| ---------- | ------ | -------- | ------ |
| `phone`    | string | true     | 手机号 |
| `password` | string | true     | 密码   |

- **返回示例**：

```json
{
    "success": true,
    "message": "success",
    "data": {
        "token": "eyJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoicmlkZXIiLCJ1c2VyX2lkIjozMDAwMDAwNCwidXNlcm5hbWUiOiJNeGkiLCJpYXQiOjE3NDc0NTIyOTYsImV4cCI6MTc0NzUzODY5Nn0.c2dYybxvjSPEV_ZHK3hVmHAjP1iVbGoG_-a4C4SjWio",
        "username": "Mxi",
        "user_id": 30000004
    },
    "code": 200
}
```

#### 3.3.3 骑手登出

- **接口名称**：骑手登出
- **请求地址**：/rider/logout
- **请求方式**：POST
- **请求参数**：无
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

#### 3.3.4 骑手注销

- **接口名称**：骑手注销
- **请求地址**：/rider/delete
- **请求方式**：DELETE
- **请求参数**：无
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

#### 3.3.5 获取当前骑手信息

- **接口名称**：获取当前骑手信息
- **请求地址**：/rider/info
- **请求方式**：GET
- **请求参数**：无
- **返回示例**：

```json
{
    "success": true,
    "message": "success",
    "data": {
        "user_id": 30000005,
        "username": "1234",
        "phone": "4445",
        "order_status": 1,
        "dispatch_mode": 1,
        "balance": 0,
        "avatar": null
    },
    "code": 200
}
```

#### 3.3.6 修改当前骑手信息

- **接口名称**：修改当前骑手信息

- **请求地址**：/rider/update

- **请求方式**：PUT

- **请求参数**：

  - | 参数名          | 类型    | 是否必填 | 说明         |
    | --------------- | ------- | -------- | ------------ |
    | `username`      | string  | false    | 新用户名     |
    | `password`      | string  | false    | 新密码       |
    | `phone`         | string  | false    | 新手机号     |
    | `order_status`  | Integer | false    | 新的接单状态 |
    | `dispatch_mode` | Integer | false    | 新接单方式   |

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

- 如果修改了用户名则会返回新token

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "token": "eyJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoicmlkZXIiLCJ1c2VyX2lkIjozMDAwMDAwNCwidXNlcm5hbWUiOiIxMjM0IiwiaWF0IjoxNzQ3NTc2NjUxLCJleHAiOjE3NDc2NjMwNTF9.ot3HBDTnpNFtPxKkJdnjAMNAdxqrTb9h2Qblv_Y-R-Y",
        "username": "1234",
        "user_id": 30000004
    },
    "code": 200
}
```

#### 3.3.7 查询可抢订单

- **请求地址**：/orders/available
- **请求方式**：GET
- **请求头**：
  - Authorization: Bearer <骑手Token>
- **请求参数**：无
- **返回示例：**

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "orders": [
            {
                "id": 70000002,
                "user_id": 10000002,
                "store_id": 40000002,
                "rider_id": null,
                "status": 0,
                "total_price": 25.00,
                "created_at": "2025-05-16T19:57:46",
                "deadline": "2025-05-16T20:42:46",
                "ended_at": null
            }
        ]
    },
    "code": 200
}
```

#### **3.3.8 抢单**

- **请求地址**：/orders/grab
- **请求方式**：PUT
- **请求头**：
  - Authorization: Bearer <骑手Token>
- **请求参数**：

| 参数名   | 类型 | 是否必填 | 说明   |
| -------- | ---- | -------- | ------ |
| order_id | Long | 是       | 订单ID |

- **请求体示例**：

```JSON
{
  "order_id": 70000002
}
```

- 返回体示例

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "order_id": 70000002,
        "status": "ACCEPTED",
        "pickup_deadline": "2025-05-17T17:32:11.668752"
    },
    "code": 200
}
```

#### **3.3.9 取消订单配送**

- **请求地址**：/orders/cancel
- **请求方式**：PUT
- **请求头**：
  - Authorization: Bearer <骑手Token>
- **请求参数**：

| 参数名   | 类型 | 是否必填 | 说明   |
| -------- | ---- | -------- | ------ |
| order_id | Long | 是       | 订单ID |

- **请求体示例**：

```Plain
{
  "order_id": 70000001
}
```

- 返回体示例

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "order_id": 70000002,
        "status": "CANCELLED"
    },
    "code": 200
}
```

#### **3.3.10 更新订单状态**

- **请求地址**：/orders/rider-update-status
- **请求方式**：POST
- **请求头**：
  - Authorization: Bearer <骑手Token>
- **请求参数**：

| 参数名        | 类型    | 是否必填 | 说明                    |
| ------------- | ------- | -------- | ----------------------- |
| order_id      | Long    | 是       | 订单ID                  |
| target_status | Integer | 是       | 目标状态（如 2 配送中） |

- **请求体示例**：

```JSON
{
  "order_id": 70000002,
  "target_status": 3,
}
```

- 返回体示例

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "order_id": 70000002,
        "status": 3,
        "updated_at": "2025-05-17T18:50:15.191527"
    },
    "code": 200
}
```

#### **3.3.11 查询骑手订单历史记录**

- **请求地址**：/orders/rider-history-query
- **请求方式**：POST
- **请求头**：
  - Authorization: Bearer <骑手Token>
- **请求参数**：

| 参数名     | 类型    | 是否必填 | 说明         |
| ---------- | ------- | -------- | ------------ |
| status     | Integer | 否       | 订单状态筛选 |
| start_time | String  | 否       | 起始时间     |
| end_time   | String  | 否       | 结束时间     |
| page       | int     | 是       | 页码         |
| page_size  | int     | 是       | 每页条数     |

- **请求体示例**：

```Plain
{
  "status": 3,
  "start_time": "2023-08-01T00:00:00",
  "end_time": "2023-08-20T23:59:59",
  "page": 1,
  "page_size": 10
}
```

- 返回体示例

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "orders": [
            {
                "order_id": 1926270955248713737,
                "status": 0,
                "total_price": 38.00,
                "delivery_price": 8.50,
                "created_at": "2025-05-25T18:50:16",
                "store_location": "天津校园内A区",
                "user_location": "111"
            },
            {
                "order_id": 80000001,
                "status": 2,
                "total_price": 38.00,
                "delivery_price": 3.00,
                "created_at": "2025-05-24T18:31:50",
                "store_location": "天津校园内A区",
                "user_location": "天津校园A宿舍楼"
            }
        ]
    },
    "code": 200
}
```

#### 3.3.12 骑手收入统计

- **请求地址**：/orders/rider-earnings
- **请求方式**：GET
- **请求头**：
- Authorization: Bearer <骑手Token>
- **请求参数**：

private Integer status;

private LocalDateTime startTime;

private LocalDateTime endTime;

private Integer page;

private Integer pageSize;

- 返回体示例

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "total_earnings": 76.00,
        "current_month": 76.00,
        "completed_orders": 2
    },
    "code": 200
}
```

### 3.4 管理员模块接口文档

#### 3.4.1. 管理员登录接口

- **接口名称**：管理员登录
- **请求地址**：`/admin/login`
- **请求方式**：POST
- **请求参数**：

| 参数名   | 类型   | 是否必填 | 说明 |
| -------- | ------ | -------- | ---- |
| admin_id | long   | 是       | id   |
| password | string | 是       | 密码 |

- **返回示例**：

成功：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "id": 10001,
        "token": "eyJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoiYWRtaW4iLCJ1c2VyX2lkIjoxMDAwMSwiaWF0IjoxNzQ3NTY0NjAyLCJleHAiOjE3NDc2NTEwMDJ9.8Wni0YSv6wuRHCoX9hiCTEGrEkewuzWqTJd_JDCHUjQ"
    },
    "code": 200
}
```

失败：

```JSON
{
    "success": false,
    "message": "该账户已登录，请先登出后再登录",
    "code": 400
}
```

#### 3.4.2. 管理员登出接口

- **接口名称**：管理员登出
- **请求地址**：`/admin/logout`
- **请求方式**：POST
- **请求参数**：无（需在header中带token） 
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": "登出成功",
    "code": 200
}
```

#### 3.4.3. 管理员按条件查看用户列表

- **接口名称**：管理员查看用户列表
- **请求地址**：`/admin/userlist`
- **请求方式**：POST
- **请求参数**：

| 参数名    | 类型   | 是否必填 | 说明                       |
| --------- | ------ | -------- | -------------------------- |
| keyword   | String | 否       | 在用户名和描述中关键词查找 |
| gender    | String | 否       | 性别                       |
| start_id  | Long   | 否       | 查询开始Id                 |
| end_id    | Long   | 否       | 查询截止Id                 |
| page      | int    | 是       | 页码                       |
| page_size | int    | 是       | 每页条数                   |

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "users": [
            {
                "id": 10000001,
                "username": "user01",
                "description": null,
                "phone": "13800000001",
                "avatar": null,
                "created_at": "2025-05-18T10:56:56"
            },
            {
                "id": 10000002,
                "username": "user02",
                "description": null,
                "phone": "13800000002",
                "avatar": null,
                "created_at": "2025-05-18T10:56:56"
            }
        ]
    },
    "code": 200
}
```

#### 3.4.4. 管理员按条件查看店铺列表

- **接口名称**：管理员查看店铺列表
- **请求地址**：`/admin/storelist`
- **请求方式**：POST
- **请求参数**：

| 参数名       | 类型       | 是否必填 | 说明               |
| ------------ | ---------- | -------- | ------------------ |
| keyword      | String     | 否       | 在名字和描述中查找 |
| type         | String     | 否       | 类型               |
| start_rating | BigDecimal | 否       | 查询起始评分       |
| end_rating   | BigDecimal | 否       | 查询截止评分       |
| status       | Integer    | 否       | 店铺状态           |
| page         | int        | 是       | 页码               |
| page_size    | int        | 是       | 每页条数           |

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "stores": [
            {
                "id": 40000001,
                "name": "store01",
                "description": "快餐",
                "location": "北京",
                "rating": 5.0,
                "balance": 0.00,
                "status": 1,
                "created_at": "2025-05-18T17:25:47",
                "image": null
            },
            {
                "id": 40000002,
                "name": "store02",
                "description": "饮品",
                "location": "上海",
                "rating": 5.0,
                "balance": 0.00,
                "status": 1,
                "created_at": "2025-05-18T17:25:47",
                "image": null
            }
        ]
    },
    "code": 200
}
```

#### 3.4.5. 管理员按条件查看骑手列表

- **接口名称**：管理员查看骑手列表
- **请求地址**：`/admin/riderlist`
- **请求方式**：POST
- **请求参数**：

| 参数名        | 类型    | 是否必填 | 说明         |
| ------------- | ------- | -------- | ------------ |
| keyword       | String  | 否       | 用户名中查询 |
| status        | Integer | 否       | 接单状态     |
| dispatch_mode | Integer | 否       | 接单模式     |
| start_balance | Long    | 否       | 查询起始余额 |
| end_balance   | Long    | 否       | 查询截止余额 |
| start_id      | Long    | 否       | 查询起始id   |
| end_id        | Long    | 否       | 查询截止id   |
| page          | int     | 是       | 页码         |
| page_size     | int     | 是       | 每页条数     |

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "riders": [
            {
                "id": 30000001,
                "username": "Mxi_test",
                "phone": "12222222222",
                "order_status": -1,
                "dispatch_mode": 1,
                "balance": 0,
                "avatar": null,
                "created_at": "2025-05-18T17:10:28"
            }
        ]
    },
    "code": 200
}
```

#### 3.4.5. 管理员按条件查看商家列表

- **接口名称**：管理员查看骑手列表
- **请求地址**：`/admin/merchantlist`
- **请求方式**：POST
- **请求参数**：

| 参数名    | 类型   | 是否必填 | 说明         |
| --------- | ------ | -------- | ------------ |
| keyword   | String | 否       | 用户名里查找 |
| start_id  | Long   | 否       | 查询起始id   |
| end_id    | Long   | 否       | 查询截止id   |
| page      | int    | 是       | 页码         |
| page_size | int    | 是       | 每页条数     |

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "merchants": [
            {
                "id": 20000001,
                "username": "merchant01",
                "phone": "13900000001",
                "avatar": null,
                "created_at": "2025-05-18T10:36:53"
            },
            {
                "id": 20000002,
                "username": "merchant02",
                "phone": "13900000002",
                "avatar": null,
                "created_at": "2025-05-18T10:36:53"
            }
        ]
    },
    "code": 200
}
```

#### 3.4.6. 管理员删除*（可选）

- **接口名称**：管理员下架店铺/商品
- **请求地址**：`/admin/delete`
- **请求方式**：DELETE
- **请求参数**：至少传递一个参数，若传递商品名则必须传递店铺名

| 参数名        | 类型   | 是否必填 | 说明   |
| ------------- | ------ | -------- | ------ |
| store_name    | string | 否       | 店铺名 |
| product_name  | string | 否       | 菜品名 |
| user_name     | string | 否       | 用户名 |
| rider_name    | string | 否       | 骑手名 |
| merchant_name | string | 否       | 商家名 |

- **返回示例**：

成功：

```JSON
{
    "success": true,
    "message": "success",
    "data": "删除成功",
    "code": 200
}
```

#### 3.4.7 管理员按条件查看所有订单

- **接口名称**：管理员按条件查看所有订单
- **请求地址**：`/admin/orderlist`
- **请求方式**：POST
- **请求参数**：可选

| 参数名    | 类型          | 是否必填 | 说明         |
| --------- | ------------- | -------- | ------------ |
| user_id   | long          | 否       | 用户名       |
| store_id  | long          | 否       | 商铺名       |
| rider_id  | long          | 否       | 骑手名       |
| status    | integer       | 否       | 订单状态     |
| create_at | LocalDateTime | 否       | 查询开始时间 |
| end_at    | LocalDateTime | 否       | 查询截止时间 |
| page      | integer       | 否       | 页码         |
| page_size | integer       | 否       | 每页条数     |

- **返回示例**：

成功：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "orders": [
            {
                "order_id": 70000001,
                "user_id": 10000001,
                "store_id": 40000001,
                "rider_id": 30000001,
                "status": 2,
                "total_price": 35.00,
                "created_at": "2025-05-16T19:57:46",
                "deadline": "2025-05-16T20:42:46",
                "ended_at": null
            }
        ]
    },
    "code": 200
}
```

#### 3.4.8 管理员按条件查看所有评价

- **接口名称**：管理员按条件查看所有评价
- **请求地址**：`/admin/reviewlist`
- **请求方式**：POST
- **请求参数**：可选

| 参数名       | 类型          | 是否必填 | 说明         |
| ------------ | ------------- | -------- | ------------ |
| user_id      | long          | 否       | 用户名       |
| store_id     | long          | 否       | 商铺名       |
| product_id   | long          | 否       | 骑手名       |
| start_time   | LocalDateTime | 否       | 查询开始时间 |
| end_time     | LocalDateTime | 否       | 查询截止时间 |
| page         | integer       | 否       | 页码         |
| page_size    | integer       | 否       | 每页条数     |
| start_rating | BigDecimal    | 否       | 查询起始评分 |
| end_rating   | BigDecimal    | 否       | 查询截止评分 |

- 返回示例

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "reviews": []
    },
    "code": 200
}
```

#### 3.4.9 管理员搜索接口

- **接口名称**：管理员搜索
- **请求地址**：`/admin/search`
- **请求方式**：POST
- **请求参数**：

| 参数名   | 类型   | 是否必填 | 说明   |
| -------- | ------ | -------- | ------ |
| key_word | string | 是       | 关键词 |

- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "data": {
        "results": [
            {
                "store_id": 40000002,
                "store_name": "store02",
                "products": {
                    "奶茶": 60000002
                }
            }
        ]
    },
    "code": 200
}
```

### 3.5 购物车模块接口文档

#### 3.5.1 添加商品到购物车

- **接口名称**：添加商品到购物车
- **请求地址**：/cart/add
- **请求方式**：POST
- **请求参数**：
  - `product_id`: string, 商品ID
  - `quantity`: integer, 商品数量
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

#### 3.5.2 查看购物车内商品列表

- **接口名称**：查看购物车内商品列表
- **请求地址**：/cart/view
- **请求方式**：GET
- **请求参数**：无
- **返回示例**：

```json
{
    "success": true,
    "message": "success",
    "data": {
        "items": [
            {
                "product_id": 60000001,
                "product_name": "炸鸡翅",
                "quantity": 1,
                "price": 15.00,
                "image_url": null
            },
            {
                "product_id": 60000003,
                "product_name": "凯撒沙拉",
                "quantity": 2,
                "price": 20.00,
                "image_url": null
            }
        ],
        "total_price": 55.00
    },
    "code": 200
}
```

#### 3.5.3 修改购物车商品

- **接口名称**：修改购物车商品
- **请求地址**：/cart/update
- **请求方式**：PUT
- **请求参数**：
  - `product_id`: string, 商品ID
  - `quantity`: integer, 新商品数量(大于0，若等于0会触发删除
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

#### 3.5.4 删除购物车商品

- **接口名称**：删除购物车商品
- **请求地址**：/cart/delete
- **请求方式**：PUT
- **请求参数**：
  - `product_id`商品ID
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

#### 3.5.5 清空购物车

- **接口名称**：清空购物车
- **请求地址**：/cart/remove
- **请求方式**：DELETE
- **请求参数**：
  - 无
- **返回示例**：

```JSON
{
    "success": true,
    "message": "success",
    "code": 200
}
```

### 3.6 消息模块接口文档

#### 3.6.1 系统通知

##### 3.6.1.1 获取系统通知列表

- **接口名称**：获取系统通知
- **请求地址**：`/messages/notifications`
- **请求方式**：GET
- **请求参数**：

| 参数名    | 类型    | 是否必填 | 说明                             |
| --------- | ------- | -------- | -------------------------------- |
| is_read   | boolean | 否       | 是否已读（true-已读 false-未读） |
| page      | int     | 否       | 分页页码（默认1）                |
| page_size | int     | 否       | 每页数量（默认10）               |

- **返回示例**：

```JSON
{
  "success": true,
  "data": {
    "unread_count": 5,
    "list": [
      {
        "id": "NT20240410001",
        "title": "系统维护通知",
        "content": "平台将于今晚00:00-02:00进行系统升级",
        "is_read": false,
        "create_time": "2025-04-10T15:30:00",
        "type": "SYSTEM" // SYSTEM-系统通知 ORDER-订单通知 COUPON-优惠券通知
      }
    ]
  }
}
```

##### 3.6.1.2 标记通知为已读

- **接口名称**：标记已读
- **请求地址**：`/messages/notifications/read`
- **请求方式**：POST
- **请求参数**：

| 参数名                        | 类型   | 是否必填 | 说明                                           |
| ----------------------------- | ------ | -------- | ---------------------------------------------- |
| message_ids（NT+date+number） | string | 是       | ["NT20240410001", "NT20240410002"]NT：通知类型 |

- **返回示例**：

```JSON
{
  "success": true,
  "message": "标记成功"
}
```

#### 3.6.2 用户私聊（实时好不好实现？能不能存储到数据库然后每隔一段时间刷新来接收）

##### 3.6.2.1 发送私信

- **接口名称**：发送消息
- **请求地址**：/messages/private
- **请求方式**：POST
- **请求参数**：

```JSON
{
  "receiver_id": "user123",
  "content": "您好，请问商品什么时候发货？",
  "type": "TEXT" // TEXT-文本 IMAGE-图片（预上传才行
}
```

- **返回示例**：

```JSON
{
  "success": true,
  "data": {
    "message_id": "MSG20240410001",
    "send_time": "2025-04-10T16:20:00"
  }
}
```

##### 3.6.2.2 获取聊天记录

- **接口名称**：获取聊天记录
- **请求地址**：/messages/private/history
- **请求方式**：GET
- **请求参数**：

| 参数名         | 类型   | 是否必填 | 说明                            |
| -------------- | ------ | -------- | ------------------------------- |
| target_user_id | string | 是       | 对方用户ID                      |
| before_time    | string | 否       | 查询此时间之前的记录（ISO格式） |
| limit          | int    | 否       | 返回条数（默认20，最大100）     |

- **返回示例**：

```JSON
{
  "success": true,
  "data": [
    {
      "id": "MSG20240409001",
      "sender_id": "user123",
      "content": "明天能送到吗？",
      "type": "TEXT",
      "create_time": "2025-04-09T10:15:00",
      "is_self": false // 是否当前用户发送
    }
  ]
}
```

##### 3.6.2.3 获取会话列表

- **接口名称**：会话列表
- **请求地址**：/messages/conversations
- **请求方式**：GET
- **请求参数**：无
- **返回示例**：

```JSON
{
  "success": true,
  "data": [
    {
      "user_id": "user123",
      "username": "张先生",
      "avatar": "https://example.com/avatar.jpg",
      "last_message": {
        "content": "好的，我会尽快发货",
        "time": "2025-04-10T11:30:00",
        "unread_count": 3
      }
    }
  ]
}
```